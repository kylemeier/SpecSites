// Generated by CoffeeScript 1.3.3
$(function(){var e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,J,K,Q,G,Y,Z,et,tt,nt,rt,it,st,ot,ut,at,ft,lt,ct,ht,pt,dt,vt,mt,gt,yt,bt,wt,Et;E=["translateX","translateY","rotate","scale","opacity"];w=590;b=564;g=1024;x=40;m=.25;S=200;T=38;y=40;N="https://player.vimeo.com/video/91475918";u=$(document);v=$(window);c=$("html");t=$("body");n=$("#content");f=$(".download-link");a=$(".download-button");p=$(".section");i=$("#cover-section");h=$("#memories-section");r=$("#conversations-section");e=$("#backedup-section");l=$("#ending-section");o=$("#device-wrapper");s=$("#device");d=$("#video");H={};X=null;A=null;P=null;J=!1;Q=window.screen.width<=480&&c.hasClass("touch");Y=window.screen.width>480&&window.screen.width<=1024&&c.hasClass("touch");K=Q||Y;G=!1;ot=0;tt=0;ut=0;dt=0;ht=1;q=null;et=null;Et=null;nt=null;O=null;st=0;I=null;B=1.5;pt=[{start:0,duration:960*B,animations:[{selector:"#background",translateY:-662,unit:"rem"},{selector:"#cover-section",translateY:-662,unit:"rem"},{selector:"#cover-image",translateX:[0,-54],translateY:[-130,67],rotate:[7,0],scale:[1,.48],opacity:[1,1]},{selector:"#memories-section",translateY:[250,-80]},{selector:"#conversations-section",opacity:[0,0]},{selector:"#backedup-section",opacity:[0,0],unit:"rem"},{selector:"#ending-section",opacity:[0,0]},{selector:"#device",translateY:[550,0],unit:"rem"},{selector:"#overlay-screen"},{selector:"#screen-list",translateY:[550,0],unit:"rem"},{selector:"#conversations-screen",opacity:[0,0]},{selector:"#conversations-response-screen",translateY:[168,168],opacity:[0,0]},{selector:"#backedup-screen",opacity:[0,0]},{selector:"#image-list",translateY:[550,0],unit:"rem"},{selector:"#kids-map-image",translateX:[79,79],translateY:[-22,-22],scale:[.46,.46]},{selector:"#highway-image",translateX:[79,79],translateY:[61,61],scale:[.46,.46]},{selector:"#boy-fish-image",translateX:[-84,-84],translateY:[144,144],scale:[.46,.46]},{selector:"#mom-dog-image",translateX:[-3,-3],translateY:[144,144],scale:[.46,.46]},{selector:"#hands-image",translateX:[78,78],translateY:[144,144],scale:[.46,.46]},{selector:"#bear-fish-image",translateX:[-48,-48],translateY:[195,195],scale:[.51,.51],opacity:[0,0]},{selector:"#tent-image",translateX:[41,41],translateY:[195,195],scale:[.51,.51],opacity:[0,0]},{selector:"#play-button",scroll:[0,30],opacity:0}]},{start:0,duration:600*B,animations:[{selector:"#memories-section",translateY:-160,opacity:0},{selector:"#conversations-section",translateY:-80,opacity:1},{selector:"#overlay-screen",translateX:-252},{selector:"#memories-screen",opacity:0},{selector:"#conversations-screen",opacity:[0,1]},{selector:"#highway-image",translateX:-64,translateY:-151,scale:.34},{selector:"#kids-map-image",translateX:-3,translateY:-151,scale:.34},{selector:"#hands-image",translateX:57,translateY:-151,scale:.34},{selector:"#mom-dog-image",translateX:-64,translateY:-90,scale:.34},{selector:"#cover-image",translateX:-14,translateY:-42,scale:.17},{selector:"#boy-fish-image",translateX:57,translateY:-90,scale:.34,opacity:1},{selector:"#conversations-response-screen",translateY:0,opacity:1},{selector:"#bear-fish-image",translateY:27,opacity:1},{selector:"#tent-image",translateY:27,opacity:1}]},{start:0,duration:600*B,animations:[{selector:"#conversations-section",translateY:-160,opacity:0},{selector:"#backedup-section",translateY:-80,opacity:1,unit:"rem"},{selector:"#overlay-screen",translateX:0},{selector:"#conversations-screen",opacity:0},{selector:"#conversations-response-screen",opacity:0},{selector:"#backedup-screen",translateY:0,opacity:1,unit:"rem"},{selector:"#cover-image",translateX:-54,translateY:28,scale:.48},{selector:"#boy-fish-image",translateX:-85,translateY:-144,scale:.46},{selector:"#mom-dog-image",translateX:-2,translateY:-144,scale:.46},{selector:"#highway-image",translateX:80,translateY:-144,scale:.46},{selector:"#kids-map-image",translateX:80,translateY:22,scale:.46},{selector:"#hands-image",translateX:80,translateY:-61,scale:.46},{selector:"#bear-fish-image",translateX:-84,translateY:106,scale:.46},{selector:"#tent-image",translateX:-2,translateY:106,scale:.46}]},{start:0,duration:600*B,animations:[{selector:"#device-wrapper",translateY:0,unit:"rem"},{selector:"#backedup-section",translateY:0,opacity:0,unit:"rem"},{selector:"#ending-section",translateY:0,opacity:1,unit:"rem"}]}];R=function(e){switch(e){case"translateX":return 0;case"translateY":return 0;case"rotate":return 0;case"scale":return 1;case"opacity":return 1;default:return null}};U=function(){var e,t,n,r,i,s,o,u;e=[];for(n=0,i=pt.length;n<i;n++){u=pt[n];o=u.animations;for(r=0,s=o.length;r<s;r++){t=o[r];t.$el=$(t.selector);$.inArray(t.selector,e)===-1&&e.push(t.selector)}}return e};V=function(e,t,n){return""+t+","+n!==H[e]};ft=function(e){if(G===e)return;G=e;t.removeClass("is-scrolled");if(G)return t.addClass("is-scrolled")};at=function(e){if(et===e)return;et=e;return it()};lt=function(e){if(e<1||e>6)return;ht>3&&e<=3&&(e=2);clearTimeout(P);ht=e;document.body.className=document.body.className.replace(/step\-\d/,"step-"+ht);p.removeClass("is-past is-present");if(ht===3)return P=setTimeout(function(){return lt(4)},500)};W=function(){var e,t,n,r,i,s,o,a,f,l,c,h,p;c=U();for(i=0,a=c.length;i<a;i++){r=c[i];n=null;for(s=0,f=pt.length;s<f;s++){p=pt[s];t=!1;h=p.animations;for(o=0,l=h.length;o<l;o++){e=h[o];if(e.selector===r){t=!0;C(e,n);n=e;break}}if(!t){n=C({selector:r,$el:$(r)},n);p.animations.push(n)}}}v.resize(rt);u.scroll(it);u.keydown(Z);return rt()};j=function(e,t,n,r){return-n/2*(Math.cos(Math.PI*e/r)-1)+t};F=function(e,t,n,r){return n*((e=e/r-1)*e*e*e*e+1)+t};_=function(e,t,n,r){var i;i=e[t];if(i){r==="out"?i=F(n,i[0],(i[1]-i[0])*n,1):i=j(n,i[0],(i[1]-i[0])*n,1);i=Math.round(i*1e4)/1e4}else i=R(t);return i};D=function(e){return(S-e)/S*(m-.01)};M=function(e,t,n){return H[e]=""+t+","+n};C=function(e,t){var n,r,i,s;for(i=0,s=E.length;i<s;i++){n=E[i];if(e[n]==null){t?r=t[n][1]:r=R(n);e[n]=[r,r]}else if(!$.isArray(e[n])){t?r=t[n][1]:r=R(n);e[n]=[r,e[n]]}}return e};gt=function(){var e,t,n,r;ut=window.pageYOffset-ot;if(Math.abs(ut)<1){clearInterval(A);ot=window.pageYOffset;return X=!1}r=ht-1;t=0;if(r>0&&r<pt.length-1){n=Math.abs(pt[r].start-ot);e=Math.abs(pt[r].start+pt[r].duration-ot);r>1&&n<S&&(t=D(n));e<S&&(t=D(e))}return ot+=ut*(q-t)};yt=function(){return ot>et?ft(!0):ft(!1)};mt=function(){var e,t,n,r,i,s;i=[];for(e=n=0,r=pt.length;n<r;e=++n){s=pt[e];t=e+1;if(ot<=s.start+s.duration){t>ht&&t-1<pt.length-1?k(t-1,1):t<ht&&t+1<pt.length-1&&k(t+1,0);ht=t;k(ht);break}i.push(void 0)}return i};z=function(){I=parseFloat(l.css("top"));bt();return vt()};bt=function(){pt[1].start=pt[0].start+pt[0].duration+200*B;pt[2].start=pt[1].start+pt[1].duration+200*B;return pt[3].start=pt[2].start+pt[2].duration+300*B};vt=function(){var e;e=l.outerHeight()-(Et-I);pt[3].duration=e*2;pt[3].animations[0].translateY=[0,-e];pt[3].animations[1].translateY=[-80,-(e+80)];pt[3].animations[2].translateY=[0,-e];n.height(pt[3].start+pt[3].duration+Et-200);O=t.outerHeight();return v.scrollTop(st*(O-Et))};k=function(e,t){var n,r,i,s,o,u,a,f,l,c,h,p,d,v,g,y;y=pt[e-1];q=y.friction||m;v=y.animations;g=[];for(p=0,d=v.length;p<d;p++){n=v[p];n.scroll=n.scroll||[0,100];a=y.start+n.scroll[0]/100*y.duration;r=y.start+n.scroll[1]/100*y.duration;s=t||Math.max(0,Math.min(1,(ot-a)/(r-a)));h=n.unit||"em";l=_(n,"translateX",s,y.ease);c=_(n,"translateY",s,y.ease);u=_(n,"scale",s,y.ease);o=_(n,"rotate",s,y.ease);i=_(n,"opacity",s,y.ease);if(h!=="%"){l/=16;c/=16}f="translate("+l+h+", "+c+h+") scale("+u+") rotate("+o+"deg)";if(V(n.selector,f,i)){n.$el.css({transform:f,opacity:i,display:"block"});g.push(M(n.selector,f,i))}else g.push(void 0)}return g};ct=function(){if(!X){X=!0;return A=setInterval(L,1e3/30)}};L=function(){gt();yt();mt();return tt=ot};wt=function(e){e.preventDefault();t.addClass("is-modal is-video");return d.html("<iframe class='video-iframe' src='"+N+"?title=0&amp;byline=0&amp;"+"portrait=0&amp;color=9f5c4a&amp;autoplay=1' width='100%' height='100%'"+"frameborder='0' webkitallowfullscreen mozallowfullscreen allowfullscreen>"+"</iframe>")};$(".video-link").click(wt);$("#cover-image").click(wt);conditionizr.ipad?$(".iphone-button, .download-link").click(function(e){e.preventDefault();return t.addClass("is-modal")}):K||a.click(function(e){e.preventDefault();return window.open(this.href)});$("#modal").click(function(e){if(e.target!==d[0]){t.removeClass("is-modal is-video");return d.html("")}});if(Q){f.click(function(e){e.preventDefault();return window.location=$(".download-button:visible").attr("href")});u.on("touchstart",function(e){J=!0;dt=e.originalEvent.touches[0].pageY;if(e.target.id==="logo"){e.preventDefault();J=!1;return lt(1)}});u.on("touchmove",function(e){var t;e.preventDefault();if(J){t=dt-e.originalEvent.touches[0].pageY;if(t>x){J=!1;return lt(ht+1)}if(t<-x){J=!1;return lt(ht-1)}}});u.on("touchend",function(e){t.removeClass("is-dragging");if(J&&$(e.target).hasClass("image-item"))return ht<6?lt(ht+1):lt(5)})}it=function(e){st=v.scrollTop()/(O-Et);if(!X)return ct()};rt=function(e){var t;t=window.innerWidth;Et=v.innerHeight();if(t>=g&&et!==w){at(w);z()}else if(t<g&&et!==b){at(b);z()}if(Et!==nt){vt();return nt=Et}};Z=function(e){switch(e.keyCode){case T:e.preventDefault();return v.scrollTop(v.scrollTop()-80);case y:e.preventDefault();return v.scrollTop(v.scrollTop()+80)}};Q&&window.isAndroid&&t.addClass("is-android-phone");if(!K&&!window.isStatic)return W()});