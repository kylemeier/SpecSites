(function(){$(function(){var e=["translateX","translateY","opacity","rotate","scale"],t=$(window),n=$("body"),r=[],i=null,s=0,o=0,u=0,a=0,f=0,l=0,c=0,h=0,p=[{wrapper:"#intro",duration:"100%",animations:[{selector:".name",translateY:-140,opacity:0},{selector:".byline",translateY:-110,opacity:0},{selector:".twitter",opacity:[1,0]}]},{wrapper:"#explosion",duration:"150%",animations:[{selector:".explosion-byline",translateY:"-25%",opacity:[0,1.75]},{selector:"#domExplosionList",translateY:"-70%",opacity:[0,1]}]},{wrapper:"#explosion",duration:"150%",animations:[{selector:".dei-1",translateY:"-15%",translateX:"-10%",opacity:[1,0],scale:2},{selector:".dei-2",translateY:"-5%",translateX:"-4%",opacity:[1,0]},{selector:".dei-3",translateY:"-9%",translateX:"2%",opacity:[1,0],scale:1.2},{selector:".dei-4",translateY:"-17%",translateX:"8%",opacity:[1,0],scale:1.5},{selector:".dei-5",translateY:"-2%",translateX:"-15%",opacity:[1,0],scale:2},{selector:".dei-6",translateY:"-1%",translateX:"-7%",opacity:[1,0],scale:1.2},{selector:".dei-7",translateY:"-4%",translateX:"2%",opacity:[1,0],scale:1.1},{selector:".dei-8",translateY:"-3%",translateX:"12%",opacity:[1,0],scale:1.8},{selector:".dei-9",translateY:"3%",translateX:"-12%",opacity:[1,0],scale:1.5},{selector:".dei-10",translateY:"5%",translateX:"-4%",opacity:[1,0]},{selector:".dei-11",translateY:"8%",translateX:"6%",opacity:[1,0],scale:1.4},{selector:".dei-12",translateY:"1%",translateX:"20%",opacity:[1,0],scale:1.9},{selector:".dei-13",translateY:"8%",translateX:"-12%",opacity:[1,0],scale:1.8},{selector:".dei-14",translateY:"4%",translateX:"-3%",opacity:[1,0],scale:1.3},{selector:".dei-15",translateY:"14%",translateX:"5%",opacity:[1,0],scale:1.7},{selector:".dei-16",translateY:"6%",translateX:"9%",opacity:[1,0],scale:2}]},{wrapper:"#explosion",duration:"100%",animations:[{selector:".explosion-byline",translateY:["-25%","-40%"],opacity:[1,0]}]},{wrapper:"#images",duration:"150%",animations:[{selector:".images-byline",translateY:"-25%",opacity:[0,1.75]},{selector:"#mediumHomepage",translateY:"-90%"},{selector:".iphone",translateY:"-66%"}]},{wrapper:"#images",duration:"75%",animations:[]},{wrapper:"#images",duration:"150%",animations:[{selector:".images-byline",translateY:["-25%","-25%"],scale:.7,opacity:[1.75,-0.75]},{selector:".images-byline-2",opacity:[0,1],translateY:"-15%"},{selector:"#mediumHomepage",translateY:["-90%","-90%"],scale:.8,opacity:-0.75},{selector:".iphone",translateY:["-66%","-90%"],translateX:"-2%",rotate:-90,scale:1.3},{selector:"#medium-profile-iphone",scale:.9,translateX:"20%"},{selector:"#davegamache-dot-com",scale:[.5,1]}]},{wrapper:"#images",duration:"40%",animations:[]},{wrapper:"#images",duration:"150%",animations:[{selector:".images-byline-2",opacity:[1,.5],translateY:["-15%","50%"],opacity:[1,-2]},{selector:".iphone",translateY:["-90%","5%"],translateX:["-2%","-2%"],rotate:[-90,-90],scale:[1.3,1.3]},{selector:"#medium-profile-iphone",translateX:["20%","20%"]},{selector:"#davegamache-dot-com",scale:[1,1]}]},{wrapper:"#links",duration:"100%",animations:[{selector:"#links",opacity:[0,2],scale:[.8,1]},{selector:".twitter",opacity:[0,1]}]},{duration:"100%",animations:[]}];init=function(){scrollIntervalID=setInterval(updatePage,10);setupValues();t.resize(throwError);isTouchDevice&&t.resize(throwError)};setupValues=function(){l=t.scrollTop();u=t.height();a=t.width();convertAllPropsToPx();buildPage()};buildPage=function(){var e,s,u;for(e=0;e<p.length;e++){o+=p[e].duration;$.inArray(p[e].wrapper,r)==-1&&r.push(p[e].wrapper);for(s=0;s<p[e].animations.length;s++)Object.keys(p[e].animations[s]).forEach(function(t){value=p[e].animations[s][t];if(t!=="selector"&&value instanceof Array==0){var n=[];n.push(getDefaultPropertyValue(t),value);value=n}p[e].animations[s][t]=value})}n.height(o);t.scroll(0);i=r[0];$(i).show()};convertAllPropsToPx=function(){var e,t,n;for(e=0;e<p.length;e++){p[e].duration=convertPercentToPx(p[e].duration,"y");for(t=0;t<p[e].animations.length;t++)Object.keys(p[e].animations[t]).forEach(function(r){value=p[e].animations[t][r];if(r!=="selector"){if(value instanceof Array)for(n=0;n<value.length;n++)typeof value[n]=="string"&&(r==="translateY"?value[n]=convertPercentToPx(value[n],"y"):value[n]=convertPercentToPx(value[n],"x"));else typeof value=="string"&&(r==="translateY"?value=convertPercentToPx(value,"y"):value=convertPercentToPx(value,"x"));p[e].animations[t][r]=value}})}};getDefaultPropertyValue=function(e){switch(e){case"translateX":return 0;case"translateY":return 0;case"scale":return 1;case"rotate":return 0;case"opacity":return 1;default:return null}};updatePage=function(){window.requestAnimationFrame(function(){setScrollTops();if(l>0&&l<=o-u){animateElements();setKeyframe()}})};setScrollTops=function(){l=t.scrollTop();c=l-f};animateElements=function(){var e,t,n,r,i,s;for(var o=0;o<p[h].animations.length;o++){e=p[h].animations[o];t=calcPropValue(e,"translateY");n=calcPropValue(e,"translateX");r=calcPropValue(e,"scale");i=calcPropValue(e,"rotate");s=calcPropValue(e,"opacity");$(e.selector).css({transform:"translate3d("+n+"px, "+t+"px, 0) scale("+r+") rotate("+i+"deg)",opacity:s})}};calcPropValue=function(e,t){var n=e[t];n?n=easeInOutQuad(c,n[0],n[1]-n[0],p[h].duration):n=getDefaultPropertyValue(t);return n};easeInOutQuad=function(e,t,n,r){return-n/2*(Math.cos(Math.PI*e/r)-1)+t};setKeyframe=function(){if(l>p[h].duration+f){f+=p[h].duration;h++;showCurrentWrappers()}else if(l<f){h--;f-=p[h].duration;showCurrentWrappers()}};showCurrentWrappers=function(){var e;if(p[h].wrapper!=i){$(i).hide();$(p[h].wrapper).show();i=p[h].wrapper}};convertPercentToPx=function(e,t){if(typeof e=="string"&&e.match(/%/g)){t==="y"&&(e=parseFloat(e)/100*u);t==="x"&&(e=parseFloat(e)/100*a)}return e};throwError=function(){n.addClass("page-error")};isTouchDevice=function(){return"ontouchstart"in window||"onmsgesturechange"in window};init()})}).call(this);